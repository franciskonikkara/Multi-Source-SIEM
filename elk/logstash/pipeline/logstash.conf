# This script transforms raw logs into a format the SIEM can understand (normalization).
input {
  file {
    # Match the internal path defined in docker-compose
    path => "/var/log/edr_simulation/edr_events.json"
    codec => "json"
    start_position => "beginning"
    sincedb_path => "/dev/null" 
    stat_interval => "1 second"
    mode => "tail"
  }
}

filter {
  if [severity] == "critical" {
    mutate { add_tag => ["ALERT_IMMEDIATE"] }
  }
}

output {
  elasticsearch {
    hosts => ["http://elasticsearch:9200"]
    index => "siem-telemetry-%{+YYYY.MM.dd}"
  }
  stdout { codec => rubydebug }
}

# This Logstash configuration file processes raw logs from the EDR simulation, normalizes them into a SIEM-compatible format, tags critical events for immediate alerts, and outputs the processed data to an Elasticsearch index for further analysis and visualization in the SIEM dashboard.
